async function fetchNote(e=null){if(!e){e=document.body.getAttribute("data-note-id")}const t=await fetch(`api/notes/${e}`);return await t.json()}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("toggleMenuButton");const t=document.getElementById("mobileMenuContainer");const n=document.getElementById("bloggerInfoCard");const o=document.getElementById("menuCard");const s=document.getElementById("main");let c=false;e.addEventListener("click",()=>{e.classList.toggle("active");if(!c){n.style.setProperty("display","flex","important");o.style.setProperty("display","flex","important");t.appendChild(n);t.appendChild(o);s.style.display="none";c=true}else{t.removeChild(n);t.removeChild(o);s.style.display="block";c=false}t.classList.toggle("showMenu")})},false);document.addEventListener("DOMContentLoaded",()=>{var e=document.querySelectorAll(".navigationItemsStyle");e.forEach(function(e){var t=e.querySelector(".menuLinkStyle");var n=e.querySelector(".dropDownStyle");if(!t||!n){return}var o=t.querySelector("svg");let s=false;t.addEventListener("mouseover",function(){s=true;n.style.display="flex";o.classList.add("unfolding")});t.addEventListener("mouseout",function(){s=false;setTimeout(function(){if(!s){n.style.display="none";o.classList.remove("unfolding")}},200)});n.addEventListener("mouseover",function(){s=true});n.addEventListener("mouseout",function(){s=false;setTimeout(function(){if(!s){n.style.display="none";o.classList.remove("unfolding")}},200)})})},false);document.addEventListener("DOMContentLoaded",()=>{var n=window.pageYOffset;const o=10;window.onscroll=function(){var e=window.pageYOffset;const t=document.getElementById("navigationBar");if(n>e){t.classList.remove("hide")}else if(e-n>o&&!document.querySelector("#mobileMenuContainer.showMenu")){t.classList.add("hide")}n=e}},false);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("rewardBtn");const t=document.getElementById("rewardImgContainer");if(e){e.addEventListener("click",function(){if(t.style.display==="flex"){t.style.opacity="0";setTimeout(function(){t.style.display="none";t.style.flexWrap=""},500)}else{t.style.opacity="1";t.style.display="flex";t.style.flexWrap="wrap"}})}},false);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("toc");if(!e)return;const t=e.clientHeight;const n=document.querySelectorAll("#content h2, #content h3, #content h4, #content h5, #content h6");const o=e.querySelectorAll("a");o.forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();e.stopPropagation();const t=document.getElementById(n.getAttribute("href").slice(1));if(t)t.scrollIntoView({behavior:"smooth"})})});function changeLinkState(){let e=n.length;while(--e&&window.scrollY<n[e].offsetTop){}o.forEach(e=>e.classList.remove("tocActive"));o[e].classList.add("tocActive")}function scrollToc(){const e=document.getElementById("toc-pane");const t=document.getElementById("toc");const n=parseFloat(window.getComputedStyle(e).getPropertyValue("max-height"));let o=e.querySelector(".tocActive");let s=o.offsetTop;if(s>n-50){e.scrollTo({top:9999,behavior:"smooth"})}else if(t.offsetHeight-s>n-50){e.scrollTo({top:0,behavior:"smooth"})}}changeLinkState();window.addEventListener("scroll",()=>{changeLinkState();setTimeout(scrollToc,500)})},false);document.addEventListener("DOMContentLoaded",()=>{if(!document.queryCommandSupported("copy")){return}function flashCopyMessage(e,t){e.textContent=t;setTimeout(function(){e.textContent="Copy"},1e3)}function selectText(e){var t=window.getSelection();var n=document.createRange();n.selectNodeContents(e);t.removeAllRanges();t.addRange(n);return t}function addCopyButton(e){var n=document.createElement("button");n.className="copyButtonStyle";n.textContent="Copy";n.setAttribute("title","Copy");var o=e.firstElementChild;n.addEventListener("click",function(){try{var e=selectText(o);document.execCommand("copy");e.removeAllRanges();flashCopyMessage(n,"Copied!")}catch(t){console&&console.log(t);flashCopyMessage(n,"Failed")}});e.appendChild(n)}var e=document.querySelectorAll("pre");Array.prototype.forEach.call(e,addCopyButton)},false);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("onTop");e.addEventListener("click",e=>{window.scrollTo({top:0,behavior:"smooth"})})},false);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("content");if(!e){return}const t=document.getElementById("articleWordCount");t.innerText=e.innerText.split(/[\s-+:,/\\]+/).filter(e=>e!=="").length},false);document.addEventListener("DOMContentLoaded",()=>{const d=document.getElementById("searchInput");const a=document.getElementById("searchResults");const t=document.getElementById("searchContainer");const e=document.getElementById("searchButton");function buildResultItem(e){return`<a class="searchItems" href="./${e.id}">
                    <div class="itemsTitle">${e.title}</div>
                </a>`}function debounce(n,o){let s;return function(...e){const t=()=>{s=null;Reflect.apply(n,null,e)};if(s)clearTimeout(s);s=setTimeout(t,o)}}async function performSearch(){const e=d.value.trim();if(e!==""){a.innerHTML="";const t=document.body.dataset.ancestorNoteId;const n=d.value;const o=await fetch(`api/notes?search=${n}&ancestorNoteId=${t}`);const s=await o.json();const c=s.results;for(const l of c){a.innerHTML+=buildResultItem(l)}}}e.addEventListener("click",()=>{t.style.display="flex"});d.addEventListener("keyup",debounce(async()=>{await performSearch()},400));document.addEventListener("click",e=>{if(!e.target.closest("#searchContainer")&&!e.target.closest("#searchButton")){t.style.display="none"}})},false);document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".playMusicButton");e.forEach(e=>{e.addEventListener("click",function(){const e=document.getElementById("toggleMenuButton");var t=`//music.163.com/m/outchain/player?type=2&auto=1&height=32`;if(getComputedStyle(e).display==="none"){t=`//music.163.com/outchain/player?type=2&auto=1&height=32`}let n=document.getElementById("musicPlayer");if(n!=null){document.body.removeChild(n)}const o=this.getAttribute("musicid");var s=document.createElement("div");s.id="musicPlayer";s.innerHTML=`<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="${t}&id=${o}"></iframe>`;document.body.appendChild(s)})})},false);